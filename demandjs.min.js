/*
 DemandJS - v.1.0.0-rc.4 

 https://github.com/hannasm/demandjs  

 MIT License

Copyright (c) 2017 Sean Hanna

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,e,a){d!=Array.prototype&&d!=Object.prototype&&(d[e]=a.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var d=0;return function(e){return $jscomp.SYMBOL_PREFIX+(e||"")+d++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(d){var e=0;return $jscomp.iteratorPrototype(function(){return e<d.length?{done:!1,value:d[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.makeIterator=function(d){$jscomp.initSymbolIterator();var e=d[Symbol.iterator];return e?e.call(d):$jscomp.arrayIterator(d)};
$jscomp.polyfill=function(d,e,a,b){if(e){a=$jscomp.global;d=d.split(".");for(b=0;b<d.length-1;b++){var c=d[b];c in a||(a[c]={});a=a[c]}d=d[d.length-1];b=a[d];e=e(b);e!=b&&null!=e&&$jscomp.defineProperty(a,d,{configurable:!0,writable:!0,value:e})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(d){function e(){this.batch_=null}function a(a){return a instanceof c?a:new c(function(b,k){b(a)})}if(d&&!$jscomp.FORCE_POLYFILL_PROMISE)return d;e.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};e.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var b=$jscomp.global.setTimeout;e.prototype.asyncExecuteFunction=function(a){b(a,
0)};e.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};e.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var c=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};c.prototype.createResolveAndReject_=
function(){function a(a){return function(k){c||(c=!0,a.call(b,k))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};c.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof c)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};c.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};c.prototype.reject_=function(a){this.settle_(2,a)};c.prototype.fulfill_=function(a){this.settle_(1,a)};c.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};c.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new e;c.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};c.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(m){c.reject(m)}};c.prototype.then=function(a,b){function f(a,b){return"function"==typeof a?function(b){try{k(a(b))}catch(r){g(r)}}:b}var k,g,d=new c(function(a,
b){k=a;g=b});this.callWhenSettled_(f(a,k),f(b,g));return d};c.prototype.catch=function(a){return this.then(void 0,a)};c.prototype.callWhenSettled_=function(a,b){function c(){switch(k.state_){case 1:a(k.result_);break;case 2:b(k.result_);break;default:throw Error("Unexpected state: "+k.state_);}}var k=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};c.resolve=a;c.reject=function(a){return new c(function(b,c){c(a)})};c.race=function(b){return new c(function(c,
f){for(var k=$jscomp.makeIterator(b),g=k.next();!g.done;g=k.next())a(g.value).callWhenSettled_(c,f)})};c.all=function(b){var f=$jscomp.makeIterator(b),k=f.next();return k.done?a([]):new c(function(b,c){function g(a){return function(c){d[a]=c;h--;0==h&&b(d)}}var d=[],h=0;do d.push(void 0),h++,a(k.value).callWhenSettled_(g(d.length-1),c),k=f.next();while(!k.done)})};return c},"es6","es3");$jscomp.owns=function(d,e){return Object.prototype.hasOwnProperty.call(d,e)};
$jscomp.polyfill("WeakMap",function(d){function e(a){$jscomp.owns(a,b)||$jscomp.defineProperty(a,b,{value:{}})}function a(a){var b=Object[a];b&&(Object[a]=function(a){e(a);return b(a)})}if(function(){if(!d||!Object.seal)return!1;try{var a=Object.seal({}),b=Object.seal({}),c=new d([[a,2],[b,3]]);if(2!=c.get(a)||3!=c.get(b))return!1;c.delete(a);c.set(b,4);return!c.has(a)&&4==c.get(b)}catch(m){return!1}}())return d;var b="$jscomp_hidden_"+Math.random().toString().substring(2);a("freeze");a("preventExtensions");
a("seal");var c=0,f=function(a){this.id_=(c+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};f.prototype.set=function(a,c){e(a);if(!$jscomp.owns(a,b))throw Error("WeakMap key fail: "+a);a[b][this.id_]=c;return this};f.prototype.get=function(a){return $jscomp.owns(a,b)?a[b][this.id_]:void 0};f.prototype.has=function(a){return $jscomp.owns(a,b)&&$jscomp.owns(a[b],this.id_)};f.prototype.delete=
function(a){return $jscomp.owns(a,b)&&$jscomp.owns(a[b],this.id_)?delete a[b][this.id_]:!1};return f},"es6","es3");$jscomp.polyfill("Object.assign",function(d){return d?d:function(d,a){for(var b=1;b<arguments.length;b++){var c=arguments[b];if(c)for(var f in c)$jscomp.owns(c,f)&&(d[f]=c[f])}return d}},"es6","es3");
var _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(d){return typeof d}:function(d){return d&&"function"===typeof Symbol&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},_createClass=function(){function d(d,a){for(var b=0;b<a.length;b++){var c=a[b];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(d,c.key,c)}}return function(e,a,b){a&&d(e.prototype,a);b&&d(e,b);return e}}();
function _classCallCheck(d,e){if(!(d instanceof e))throw new TypeError("Cannot call a class as a function");}
(function(d){d=function(){function d(a){var b=this;_classCallCheck(this,d);this.phRegistry=new WeakMap;this.loaded=new WeakMap;this.injecting=new WeakMap;var c={};a&&"linkHandler"in a&&(c=a.linkHandler,delete a.linkHandler);this.defaultLoadingHtml='<div style="width:100%;height:100%">Loading In Progress</div>';this.defaultFailureHtml='<div style="background-color:#F00;color:#FFF;font-size:20pt;">ERROR</div>';this.options=Object.assign({demandClassAttribute:"data-demand",defaultDemandClass:"default",
loadingHtml:this.defaultLoadingHtml,failureHtml:this.defaultFailureHtml,createLoadingNode:function(a){return b.createLoadingNode(a)},createFailureNode:function(a,c){return b.createFailureNode(a,c)},shouldRemove:function(a){return!("tagName"in a)||!a.tagName.match(/link/i)},shouldInsertOnLoad:function(a){return b.options.shouldRemove(a)},selector:"img,video,picture,iframe,link.demand",ignoreSelector:".nodemand",rootMargin:"48px",threshold:.001,onLoadBegin:function(a){return b.onLoadBegin(a)},onLoadSuccess:function(a){return b.onLoadSuccess(a)},
onLoadFailure:function(a,c){return b.onLoadFailure(a,c)},onLoadComplete:function(a){return b.onLoadComplete(a)},linkHandler:{"text/html":function(a,c){return b.injectHtml(a,c)},"application/xhtml+xml":function(a,c){return b.injectHtml(a,c)}}},a);this.options.linkHandler=Object.assign(this.options.linkHandler,c);this.mutation=new MutationObserver(function(a,c){return b.observeMutation(a,c)});this.mutationOptions={childList:!0,subtree:!0};this.intersectionOptions={root:null,rootMargin:this.options.rootMargin,
threshold:this.options.threshold};this.intersection=new IntersectionObserver(function(a,c){return b.observeIntersection(a,c)},this.intersectionOptions);this.observeTargets(this.queryTargets());this.mutation.observe(document.body,this.mutationOptions)}_createClass(d,[{key:"observeMutation",value:function(a){var b=!0,c=!1,f=void 0;try{for(var d=a[Symbol.iterator](),g;!(b=(g=d.next()).done);b=!0){var h=g.value;if("childList"===h.type){a=!0;var e=!1,l=void 0;try{for(var n=h.addedNodes[Symbol.iterator](),
p;!(a=(p=n.next()).done);a=!0)this.checkAdditionRecursive(p.value)}catch(q){e=!0,l=q}finally{try{!a&&n.return&&n.return()}finally{if(e)throw l;}}}}}catch(q){c=!0,f=q}finally{try{!b&&d.return&&d.return()}finally{if(c)throw f;}}}},{key:"checkAdditionRecursive",value:function(a){var b=this.isTargetMatch(a);if(!b.loaded){if(b.isScript&&b.injecting){this.injectedScript(a,b.injecting);return}if(b.isMatch){this.observeTarget(a);return}}if(a.children){b=!0;var c=!1,f=void 0;try{for(var d=a.children[Symbol.iterator](),
g;!(b=(g=d.next()).done);b=!0)this.checkAdditionRecursive(g.value)}catch(h){c=!0,f=h}finally{try{!b&&d.return&&d.return()}finally{if(c)throw f;}}}}},{key:"observeIntersection",value:function(a){var b=!0,c=!1,f=void 0;try{for(var d=a[Symbol.iterator](),g;!(b=(g=d.next()).done);b=!0){var h=g.value;if(h.isIntersecting&&!(0>=h.intersectionRatio)){var e=this.phRegistry.get(h.target);void 0===e||e.loading||(e.loading=!0,this.beginLoad(e))}}}catch(l){c=!0,f=l}finally{try{!b&&d.return&&d.return()}finally{if(c)throw f;
}}}},{key:"beginLoad",value:function(a){var b=this,c=this.resolveTarget(a);a=c.target;var f=c.registration;if(f.extraData.shouldInjectLink){var d=f.extraData.href;this.selectByDemandClass(a,this.options.onLoadBegin,this.options.demandClassAttribute,this.options.defaultDemandClass,this.onLoadBegin).call(this,a);fetch(d).then(function(a){if(!a.ok){var b=Error('Fetching "'+d+'" failed with '+a.status+" "+a.statusText);b.responseDetail=a;throw b;}return a.text()}).then(function(a){b.injectLink(f,a)}).catch(function(a){b.handleError(f,
a)})}else if(f.extraData.shouldRestore)setTimeout(function(){return b.restoreTarget(f)},0);else throw"Unknown load operation";}},{key:"isResourceLoaded",value:function(a){return a.complete||!1}},{key:"injectLink",value:function(a,b){var c=this.resolveTarget(a);a=c.target;c=c.registration;var f=c.extraData.type;if(f in this.options.linkHandler)(0,this.options.linkHandler[f])(a,b);else throw"Unknown link demand with content type: "+f;this.processSuccess(c)}},{key:"injectedScript",value:function(a,b){var c=
this,f=b.id,d=Promise.resolve(a.innerHTML);"src"in a&&a.src&&(d=fetch(a.src).then(function(a){if(!a.ok)throw Error(a.status+"_"+a.statusText);return a.text()}),f=a.src+"#"+f);d.then(function(d){c.injectScript(a,b.href+".demand["+f+"].js",d)})}},{key:"injectScript",value:function(a,b,c){var f=document.write,d="";document.write=function(a){return d+=a};(new Function(c+"\n//@ sourceURL="+b))();""!==d&&this.injectHtml(a,"<body>"+d+"</body>");document.write=f}},{key:"injectHtml",value:function(a,b){var c=
document.createElement("html");c.innerHTML=b;var f=c.getElementsByTagName("body");b=1;f=Array.prototype.slice.call(f);c=!0;var d=!1,g=void 0;try{for(var h=f[Symbol.iterator](),e;!(c=(e=h.next()).done);c=!0){var l=Array.prototype.slice.call(e.value.children);f=!0;var n=!1,p=void 0;try{for(var q=l[Symbol.iterator](),u;!(f=(u=q.next()).done);f=!0){var r=u.value;this.injecting.set(r,{href:a.href,id:b});b+=1;a.parentNode.insertBefore(r,a)}}catch(t){n=!0,p=t}finally{try{!f&&q.return&&q.return()}finally{if(n)throw p;
}}}}catch(t){d=!0,g=t}finally{try{!c&&h.return&&h.return()}finally{if(d)throw g;}}}},{key:"processSuccess",value:function(a){var b=this.resolveTarget(a);a=b.target;b=b.registration;var c=this.options.shouldInsertOnLoad(b.target),d=!0,k=!1,g=void 0;try{for(var e=b.placeholders[Symbol.iterator](),m;!(d=(m=e.next()).done);d=!0){var l=m.value;c&&(c=!1,l.parentNode.insertBefore(b.target,l));this.cleanupPlaceholder(l)}}catch(n){k=!0,g=n}finally{try{!d&&e.return&&e.return()}finally{if(k)throw g;}}this.cleanupRegistrationTarget(b);
this.selectByDemandClass(a,this.options.onLoadSuccess,this.options.demandClassAttribute,this.options.defaultDemandClass,this.onLoadSuccess).call(this,a);this.selectByDemandClass(a,this.options.onLoadComplete,this.options.demandClassAttribute,this.options.defaultDemandClass,this.onLoadComplete).call(this,a)}},{key:"cleanupPlaceholder",value:function(a){this.intersection.unobserve(a);a.parentNode.removeChild(a);this.phRegistry.delete(a)}},{key:"cleanupRegistrationTarget",value:function(a){this.intersection.unobserve(a.target);
this.phRegistry.delete(a.target);this.loaded.set(a.target,!0)}},{key:"handleError",value:function(a,b){var c=this.resolveTarget(a);a=c.target;c=c.registration;b&&b.stack&&b.message||(b=b?Error(b):Error("No error was provided on load"));var d=this.selectByDemandClass(a,this.options.onLoadFailure,this.options.demandClassAttribute,this.options.defaultDemandClass,this.onLoadFailure),e=!0,g=!0,h=!1,m=void 0;try{for(var l=c.placeholders[Symbol.iterator](),n;!(g=(n=l.next()).done);g=!0){var p=n.value;e&&
(e=!1,a.parentNode||p.parentNode.insertBefore(a,p),d.call(this,a,b));this.cleanupPlaceholder(p)}}catch(q){h=!0,m=q}finally{try{!g&&l.return&&l.return()}finally{if(h)throw m;}}e&&d.call(this,a,b);this.cleanupRegistrationTarget(c);this.selectByDemandClass(a,this.options.onLoadComplete,this.options.demandClassAttribute,this.options.defaultDemandClass,this.onLoadComplete).call(this,a)}},{key:"onLoadBegin",value:function(a){}},{key:"onLoadSuccess",value:function(a){}},{key:"onLoadComplete",value:function(a){}},
{key:"onLoadFailure",value:function(a,b){b=this.selectByDemandClass(a,this.options.createFailureNode,this.options.demandClassAttribute,this.options.defaultDemandClass,this.createFailureNode).call(this,a,b);b=Array.prototype.slice.call(b);var c=!0,d=!1,e=void 0;try{for(var g=b[Symbol.iterator](),h;!(c=(h=g.next()).done);c=!0){var m=h.value;this.loaded.set(m,!0);a.parentNode.insertBefore(m,a)}}catch(l){d=!0,e=l}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e;}}this.options.shouldRemove(a)&&
a.parentNode.removeChild(a)}},{key:"selectByDemandClass",value:function(a,b,c,d,e){if(!b)return e;if("object"===("undefined"===typeof b?"undefined":_typeof(b))){var f=d;a.hasAttribute(c)&&(f=a.getAttribute(c));do{if(f in b){b=b[f];break}else if(f===d){b=e;break}f=d}while(1)}return b}},{key:"createFailureNode",value:function(a,b){b=document.createElement("div");a=this.selectByDemandClass(a,this.options.failureHtml,this.options.demandClassAttribute,this.options.defaultDemandClass,this.defaultFailureHtml);
b.innerHTML=a;return b.childNodes}},{key:"createLoadingNode",value:function(a){var b=document.createElement("div");a=this.selectByDemandClass(a,this.options.loadingHtml,this.options.demandClassAttribute,this.options.defaultDemandClass,this.defaultLoadingHtml);b.innerHTML=a;return b.childNodes}},{key:"registerPlaceholder",value:function(a,b,c,d){b={isRegistration:!0,target:b,node:a,placeholders:c,extraData:d,loading:!1};this.phRegistry.set(a,b);return b}},{key:"resolveTarget",value:function(a){var b=
a;"isRegistration"in a&&a.isRegistration?a=b.target:b=this.phRegistry.get(a);return{target:a,registration:b}}},{key:"restoreTarget",value:function(a){var b=this.resolveTarget(a);a=b.target;b=b.registration;var c=b.extraData;b.loading=!0;this.selectByDemandClass(a,this.options.onLoadBegin,this.options.demandClassAttribute,this.options.defaultDemandClass,this.onLoadBegin).call(this,a);this._restoreTargetInternal(a,c);c.canLoad||this.processSuccess(b)}},{key:"_restoreTargetInternal",value:function(a,
b){b.hasSrcset&&a.setAttribute("srcset",b.srcset);b.hasSizes&&a.setAttribute("sizes",b.sizes);b.hasSrc&&a.setAttribute("src",b.src);if(0<b.children.length)for(a=0;a<b.children.length;a++){var c=b.children[a];this._restoreTargetInternal(c.target,c)}}},{key:"captureTarget",value:function(a,b){var c=this,d={target:a,hasSrc:a.hasAttribute("src"),src:a.getAttribute("src"),hasSrcset:a.hasAttribute("srcset"),srcset:a.getAttribute("srcset"),hasSizes:a.hasAttribute("sizes"),sizes:a.getAttribute("sizes"),isLink:"tagName"in
a&&a.tagName.match(/link/i),hasHref:a.hasAttribute("href"),href:a.getAttribute("href"),hasType:a.hasAttribute("type"),type:a.getAttribute("type"),children:[],shouldRestore:!1,canLoad:!1,shouldInjectLink:!1};d.hasSrc&&a.removeAttribute("src");d.hasSrcset&&a.removeAttribute("srcset");d.hasSizes&&a.removeAttribute("sizes");d.isLink&&d.hasHref&&(d.shouldInjectLink=!0,d.hasType||(d.type="text/html"));(d.hasSrc||d.hasSrcset)&&a===b&&(d.shouldRestore=!0,d.canLoad=!0,a.addEventListener("load",function(a){return c.processSuccess(b)}),
d.hasSrcset&&d.hasSrc?a.addEventListener("error",function(a){c.handleError(b,Error("Loading for srcset and src failed ("+d.srcset+")("+d.src+")"))}):d.hasSrcset?a.addEventListener("error",function(a){c.handleError(b,Error("Loading for srcset failed ("+d.srcset+")"))}):d.hasSrc?a.addEventListener("error",function(a){c.handleError(b,Error("Loading for src failed ("+d.src+")"))}):a.addEventListener("error",function(a){c.handleError(b,Error("Loading srced element failed (FALLBACK ERROR MSG)"))}));if("tagName"in
a&&a.tagName.match(/picture|video|audio/i)){a===b&&(d.shouldRestore=!0);for(var e=0;e<a.children.length;e++){var g=this.captureTarget(a.children[e]);g.index=e;d.children.push(g)}}return d}},{key:"isContextExcluded",value:function(a){return a&&"parentNode"in a?(a=a.parentNode)&&"tagName"in a?a.tagName.match(/picture|video|audio/i)?!0:this.isContextExcluded(a):!1:!1}},{key:"observeTarget",value:function(a){if(!this.isResourceLoaded(a)&&!this.isContextExcluded(a)){var b=this.captureTarget(a,a),c=this.selectByDemandClass(a,
this.options.createLoadingNode,this.options.demandClassAttribute,this.options.defaultDemandClass,this.createLoadingNode).call(this,a);c=Array.prototype.slice.call(c);var d=!0,e=!1,g=void 0;try{for(var h=c[Symbol.iterator](),m;!(d=(m=h.next()).done);d=!0){var l=m.value;this.registerPlaceholder(l,a,c,b);this.loaded.set(l,!0);a.parentNode.insertBefore(l,a);this.intersection.observe(l)}}catch(n){e=!0,g=n}finally{try{!d&&h.return&&h.return()}finally{if(e)throw g;}}this.registerPlaceholder(a,a,c,b);this.options.shouldRemove(a)?
a.parentNode.removeChild(a):this.intersection.observe(a)}}},{key:"observeTargets",value:function(a){var b=!0,c=!1,d=void 0;try{for(var e=a[Symbol.iterator](),g;!(b=(g=e.next()).done);b=!0)this.observeTarget(g.value)}catch(h){c=!0,d=h}finally{try{!b&&e.return&&e.return()}finally{if(c)throw d;}}}},{key:"isLoadedRecursive",value:function(a,b){return this.loaded.has(a)?{loaded:!0,injecting:b||this.injecting.get(a)}:!b&&a.parentNode?this.isLoadedRecursive(a.parentNode,b||this.injecting.get(a)):{loaded:!1,
injecting:b||this.injecting.get(a)}}},{key:"isScript",value:function(a){return!!("tagName"in a&&a.tagName.match(/^script$/i))}},{key:"isTargetMatch",value:function(a){var b="matches"in a&&a.matches(this.options.selector);b=b&&!(this.options.ignoreSelector&&a.matches(this.options.ignoreSelector));var c=this.isScript(a);if(!b&&!c)return{isMatch:b,isScript:c,loaded:!1,injecting:!1};a=this.isLoadedRecursive(a,!1);a.isMatch=b;a.isScript=c;return a}},{key:"queryTargets",value:function(){var a=[],b=!0,c=
!1,d=void 0;try{for(var e=document.querySelectorAll(this.options.selector)[Symbol.iterator](),g;!(b=(g=e.next()).done);b=!0){var h=g.value;this.options.ignoreSelector&&"matches"in h&&h.matches(this.options.ignoreSelector)||a.push(h)}}catch(m){c=!0,d=m}finally{try{!b&&e.return&&e.return()}finally{if(c)throw d;}}return a}},{key:"shouldRemove",value:function(a){return!("tagName"in a)||!a.tagName.match(/link/i)}}]);return d}();window.DemandJS=d})(window);
